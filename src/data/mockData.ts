import { Equipment, EquipmentStatus, EquipmentType, SensorReading, FailurePrediction, MaintenanceRecord, FailureMode, PredictionStatus, MaintenanceType, WorkOrderStatus } from "@/types/equipment";

// Mock Equipment Data
export const mockEquipment: Equipment[] = [
  {
    id: "eq-001",
    equipmentId: "PUMP-001",
    name: "Hydraulic Pump #1",
    type: EquipmentType.PUMP,
    manufacturer: "Flowserve",
    model: "HPX-500",
    factoryId: "FACTORY-A",
    productionLine: "Line 1",
    location: { x: 10, y: 20, zone: "Zone A" },
    installationDate: new Date("2020-01-15"),
    criticalityScore: 0.9,
    status: EquipmentStatus.OPERATIONAL,
    currentHealthScore: 0.45,
    lastMaintenanceDate: new Date("2024-11-01"),
    nextScheduledMaintenance: new Date("2025-02-01"),
    degradationRate: 0.02,
    typicalFailureModes: ["bearing_failure", "seal_failure"],
  },
  {
    id: "eq-002",
    equipmentId: "MOTOR-001",
    name: "Drive Motor #3",
    type: EquipmentType.MOTOR,
    manufacturer: "Siemens",
    model: "1LE1",
    factoryId: "FACTORY-A",
    productionLine: "Line 1",
    location: { x: 15, y: 25, zone: "Zone A" },
    installationDate: new Date("2019-06-20"),
    criticalityScore: 0.85,
    status: EquipmentStatus.DEGRADED,
    currentHealthScore: 0.62,
    lastMaintenanceDate: new Date("2024-10-15"),
    nextScheduledMaintenance: new Date("2025-01-15"),
    degradationRate: 0.015,
    typicalFailureModes: ["motor_failure", "electrical_failure"],
  },
  {
    id: "eq-003",
    equipmentId: "CONV-001",
    name: "Conveyor Belt B2",
    type: EquipmentType.CONVEYOR,
    manufacturer: "Dorner",
    model: "3200",
    factoryId: "FACTORY-A",
    productionLine: "Line 2",
    location: { x: 30, y: 40, zone: "Zone B" },
    installationDate: new Date("2021-03-10"),
    criticalityScore: 0.7,
    status: EquipmentStatus.OPERATIONAL,
    currentHealthScore: 0.78,
    lastMaintenanceDate: new Date("2024-12-01"),
    nextScheduledMaintenance: new Date("2025-03-01"),
    degradationRate: 0.01,
    typicalFailureModes: ["bearing_failure"],
  },
  {
    id: "eq-004",
    equipmentId: "COMP-001",
    name: "Air Compressor #2",
    type: EquipmentType.COMPRESSOR,
    manufacturer: "Atlas Copco",
    model: "GA-37",
    factoryId: "FACTORY-B",
    productionLine: "Line 1",
    location: { x: 5, y: 10, zone: "Zone C" },
    installationDate: new Date("2018-09-05"),
    criticalityScore: 0.95,
    status: EquipmentStatus.OPERATIONAL,
    currentHealthScore: 0.88,
    lastMaintenanceDate: new Date("2024-12-15"),
    nextScheduledMaintenance: new Date("2025-03-15"),
    degradationRate: 0.008,
    typicalFailureModes: ["seal_failure", "motor_failure"],
  },
  {
    id: "eq-005",
    equipmentId: "MIX-001",
    name: "Industrial Mixer #5",
    type: EquipmentType.MIXER,
    manufacturer: "Charles Ross",
    model: "VMS-100",
    factoryId: "FACTORY-B",
    productionLine: "Line 2",
    location: { x: 20, y: 35, zone: "Zone D" },
    installationDate: new Date("2022-01-20"),
    criticalityScore: 0.6,
    status: EquipmentStatus.OPERATIONAL,
    currentHealthScore: 0.92,
    lastMaintenanceDate: new Date("2024-11-20"),
    nextScheduledMaintenance: new Date("2025-02-20"),
    degradationRate: 0.005,
    typicalFailureModes: ["bearing_failure", "motor_failure"],
  },
  {
    id: "eq-006",
    equipmentId: "PUMP-002",
    name: "Cooling Pump #4",
    type: EquipmentType.PUMP,
    manufacturer: "Grundfos",
    model: "CR-95",
    factoryId: "FACTORY-A",
    productionLine: "Line 3",
    location: { x: 45, y: 15, zone: "Zone A" },
    installationDate: new Date("2020-07-12"),
    criticalityScore: 0.8,
    status: EquipmentStatus.MAINTENANCE,
    currentHealthScore: 0.35,
    lastMaintenanceDate: new Date("2024-12-28"),
    nextScheduledMaintenance: new Date("2025-01-05"),
    degradationRate: 0.025,
    typicalFailureModes: ["seal_failure", "hydraulic_failure"],
  },
];

// Generate sensor readings for equipment
export const generateSensorReadings = (equipmentId: string, count: number = 50): SensorReading[] => {
  const now = Date.now();
  return Array.from({ length: count }, (_, i) => ({
    id: `sr-${equipmentId}-${i}`,
    equipmentId,
    timestamp: new Date(now - (count - i) * 60000),
    temperature: 65 + Math.random() * 30 + Math.sin(i / 5) * 10,
    vibration: 2 + Math.random() * 3 + (i > 40 ? Math.random() * 2 : 0),
    pressure: 100 + Math.random() * 20,
    humidity: 40 + Math.random() * 20,
    powerConsumption: 50 + Math.random() * 30,
    throughput: 80 + Math.random() * 20,
    isAnomaly: i > 45 && Math.random() > 0.7,
    anomalyScore: i > 45 ? 0.3 + Math.random() * 0.5 : Math.random() * 0.2,
  }));
};

// Mock Predictions
export const mockPredictions: FailurePrediction[] = [
  {
    id: "pred-001",
    equipmentId: "eq-001",
    predictionTime: new Date(),
    failureProbability: 0.78,
    confidenceScore: 0.85,
    predictionHorizonDays: 7,
    expectedFailureDate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000),
    expectedFailureMode: FailureMode.BEARING_FAILURE,
    estimatedCost: 15000,
    topContributingFactors: [
      { factor: "Vibration Increase", importance: 0.35, currentValue: 4.2, contribution: 0.4 },
      { factor: "Temperature Trend", importance: 0.28, currentValue: 78, contribution: 0.3 },
      { factor: "Operating Hours", importance: 0.22, currentValue: 12500, contribution: 0.2 },
    ],
    predictionStatus: PredictionStatus.ACTIVE,
    isAcknowledged: false,
    alertSent: true,
  },
  {
    id: "pred-002",
    equipmentId: "eq-002",
    predictionTime: new Date(),
    failureProbability: 0.56,
    confidenceScore: 0.72,
    predictionHorizonDays: 14,
    expectedFailureDate: new Date(Date.now() + 14 * 24 * 60 * 60 * 1000),
    expectedFailureMode: FailureMode.MOTOR_FAILURE,
    estimatedCost: 8500,
    topContributingFactors: [
      { factor: "Power Consumption", importance: 0.4, currentValue: 72, contribution: 0.35 },
      { factor: "Temperature", importance: 0.3, currentValue: 85, contribution: 0.25 },
    ],
    predictionStatus: PredictionStatus.ACTIVE,
    isAcknowledged: true,
    alertSent: true,
  },
  {
    id: "pred-003",
    equipmentId: "eq-006",
    predictionTime: new Date(),
    failureProbability: 0.89,
    confidenceScore: 0.92,
    predictionHorizonDays: 3,
    expectedFailureDate: new Date(Date.now() + 3 * 24 * 60 * 60 * 1000),
    expectedFailureMode: FailureMode.SEAL_FAILURE,
    estimatedCost: 5200,
    topContributingFactors: [
      { factor: "Pressure Drop", importance: 0.45, currentValue: 82, contribution: 0.5 },
      { factor: "Leak Detection", importance: 0.35, currentValue: 1, contribution: 0.35 },
    ],
    predictionStatus: PredictionStatus.ACTIVE,
    isAcknowledged: false,
    alertSent: true,
  },
];

// Mock Maintenance Records
export const mockMaintenanceRecords: MaintenanceRecord[] = [
  {
    id: "maint-001",
    equipmentId: "eq-001",
    startTime: new Date("2024-11-01T08:00:00"),
    endTime: new Date("2024-11-01T12:00:00"),
    maintenanceType: MaintenanceType.PREVENTIVE,
    description: "Regular bearing inspection and lubrication",
    technicianName: "John Smith",
    totalCost: 450,
    workOrderStatus: WorkOrderStatus.COMPLETED,
    issuesFound: ["Minor bearing wear detected"],
  },
  {
    id: "maint-002",
    equipmentId: "eq-002",
    startTime: new Date("2024-10-15T09:00:00"),
    endTime: new Date("2024-10-15T16:00:00"),
    maintenanceType: MaintenanceType.CORRECTIVE,
    description: "Motor winding repair",
    technicianName: "Mike Johnson",
    totalCost: 2200,
    workOrderStatus: WorkOrderStatus.COMPLETED,
    issuesFound: ["Damaged motor windings", "Overheating signs"],
  },
  {
    id: "maint-003",
    equipmentId: "eq-006",
    startTime: new Date("2024-12-28T10:00:00"),
    maintenanceType: MaintenanceType.PREDICTIVE,
    description: "Seal replacement based on AI prediction",
    technicianName: "Sarah Williams",
    totalCost: 1800,
    workOrderStatus: WorkOrderStatus.IN_PROGRESS,
    issuesFound: [],
  },
];

// Calculate stats
export const calculateDashboardStats = (equipment: Equipment[]) => {
  const healthy = equipment.filter(e => e.currentHealthScore >= 0.8).length;
  const warning = equipment.filter(e => e.currentHealthScore >= 0.6 && e.currentHealthScore < 0.8).length;
  const critical = equipment.filter(e => e.currentHealthScore < 0.6).length;
  const avgHealth = equipment.reduce((sum, e) => sum + e.currentHealthScore, 0) / equipment.length;
  
  return { healthy, warning, critical, avgHealth, total: equipment.length };
};
